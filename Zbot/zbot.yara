rule ZBot_Trojan {
  meta:
    description = "Yara rules for ZBot Trojan matches the PE magic bytes and common string"
    author = "somedieyoungZZ"
    date = "2024-03-05"
    reference = "http://somedieyoungzz.github.io/zeus-banking-trojan-analysis/"

  strings:
    $magic = {4D 5A}
    $flash_url = {
	"http*://fpdownload.macromedia.com/get/flashplayer/update/current/install/install_all_win_cab_ax_sgn.z",
	"corect.com"
}
  imports:
    $ CreateFileA = { api("CreateFileA") }
    $ WinExec = { api("WinExec") }
    $ GetAsyncKeyState = { api("GetAsyncKeyState") }

  condition:
    all of ($magic, any of ($suspicious_url))  # Checks for PE header and suspicious URL
    any of ($ CreateFileA, $ WinExec, $ GetAsyncKeyState )  # Checks for any of the suspicious imports
}
